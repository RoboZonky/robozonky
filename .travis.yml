language: java
env:
  global:
    - JAVA_OPTS=-Xmx2g
    - MAVEN_OPTS=$JAVA_OPTS
addons: # make sure we're using the latest Java as Travis default is quite old
  apt:
    packages:
      - oracle-java8-installer
      - oracle-java9-installer
os:
  - linux
matrix: # split execution per-module so that PITest doesn't cause the build to timeout
  - env: MODULE=robozonky-api
    jdk: oraclejdk8
  - env: MODULE=robozonky-api
    jdk: oraclejdk9
  - env: MODULE=robozonky-common
    jdk: oraclejdk8
  - env: MODULE=robozonky-common
    jdk: oraclejdk9
  - env: MODULE=robozonky-integration-zonkoid
    jdk: oraclejdk8
  - env: MODULE=robozonky-integration-zonkoid
    jdk: oraclejdk9
  - env: MODULE=robozonky-notifications
    jdk: oraclejdk8
  - env: MODULE=robozonky-notifications
    jdk: oraclejdk9
  - env: MODULE=robozonky-strategy-natural
    jdk: oraclejdk8
  - env: MODULE=robozonky-strategy-natural
    jdk: oraclejdk9
  - env: MODULE=robozonky-app
    jdk: oraclejdk8
  - env: MODULE=robozonky-app
    jdk: oraclejdk9
  - env: MODULE=robozonky-installer
    jdk: oraclejdk8
  - env: MODULE=robozonky-installer
    jdk: oraclejdk9
cache:
  directories:
  - $HOME/.m2
install:
  - mvn --batch-mode -T 1.5C clean install -DskipTests -Dgpg.skip
script:
  - cd $MODULE
  - mvn --batch-mode install -Dassembly.skipAssembly -Dgpg.skip
